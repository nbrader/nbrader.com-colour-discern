<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="ColourDiscerningTest.css">
    <title>Color Choice Game</title>
</head>
<body>
    <div id="instructions">
        <h2>Welcome to the Colour Discerning Test</h2>
        <p>
            In this exercise, you will be shown two colors labeled as "A" and "B". After pressing "Continue", one of the colors will be presented to you. Your task is to identify which label (either "A" or "B") corresponds to the color shown.
        </p>
        <label for="name">Your Name:</label>
        <input type="text" id="name" placeholder="Enter your name">

        <label for="deviationPercent">Deviation Percent:</label>
        <input type="number" id="deviationPercent" min="0" max="100" step="0.1" placeholder="Enter percentage (0-100)" value="50">
        
        <input type="file" id="csvUpload" accept=".csv">
        
        <button id="start">Start</button>
    </div>
    <div id="content" style="display: none;">
        <p id="memorizeInstruction">Memorize the colors below.</p>
        <div id="colors">
            <div class="color-box" id="a">
                <p>A</p>
                <div class="color"></div>
                <div class="color-name"></div> <!-- Added element for displaying hue name -->
            </div>
            <div class="color-box" id="b">
                <p>B</p>
                <div class="color"></div>
                <div class="color-name"></div> <!-- Added element for displaying hue name -->
            </div>
        </div>
        <button id="continue">Continue</button>
        <button id="showResults">Show Results</button>
    </div>

    <div id="choiceScreen" style="display: none;">
        <p id="choiceInstruction">Which color was this one?</p>
        <div class="color-box" id="testColor">
            <div class="color"></div>
        </div>
        <button id="chooseA">A</button>
        <button id="chooseB">B</button>
    </div>
    
    <div id="resultsCanvas" style="display: none; width: 100vw; height: 100vh;">

        <!-- 3D Visualization Controls -->
        <div id="visualizer3D" style="width: 100%; padding: 20px 0;">
            <!-- Making each label-input pair a block-level element for vertical stacking -->
            <div style="margin-bottom: 10px;">
                <label for="whiteLinesToggle">Show White Lines for Confused Colors:</label>
                <input type="checkbox" id="whiteLinesToggle" checked>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="darkBlueLinesToggle">Show Dark Blue Lines for Distinguished Colors:</label>
                <input type="checkbox" id="darkBlueLinesToggle" checked>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="lightPrevColsToggle">Show Previously Memorized Colors:</label>
                <input type="checkbox" id="lightPrevColsToggle" checked>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="greyOutlinesToggle">Highlight Previously Memorized Colours:</label>
                <input type="checkbox" id="greyOutlinesToggle">
            </div>

            <div style="margin-bottom: 10px;">
                <label for="gridDotsToggle">Show 3D Grid of Colours:</label>
                <input type="checkbox" id="gridDotsToggle">
            </div>

            <div style="margin-bottom: 10px;">
                <label for="gridToggle">Show Zero Planes:</label>
                <input type="checkbox" id="gridToggle" checked>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="normalizeToggle">Normalize Histogram:</label>
                <input type="checkbox" id="normalizeToggle">
            </div>

            <!-- Canvas for 3D visualization will be appended here by THREE.js -->
        </div>

        <!-- Histogram -->
        <div id="histogram2D" style="width:600px; height:200px; position: relative; margin: 20px auto;">
            <h3 style="text-align: center; margin-bottom: 5px;">Color Discrimination Histogram</h3>
            <!-- Canvas for 2D histogram will be appended here by THREE.js -->
        </div>

        <!-- Buttons -->
        <div style="text-align: center;">
            <button id="download">Export CSV</button>
            <!-- Added a little margin for separation -->
            <button id="backToResults" style="margin-left: 20px;">Back</button>
        </div>
    </div>
    
    <div id="waitingMessage" style="display: none; color: white; font-size: 24px;">
        Wait for <span id="countdown">8</span> seconds...
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r122/three.min.js"></script>
    <script src="https://threejsfundamentals.org/threejs/resources/threejs/r110/examples/js/controls/OrbitControls.js"></script>
    <script src="ColourDiscerningTest.js"></script>
</body>
</html>
